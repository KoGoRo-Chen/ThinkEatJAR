<!DOCTYPE html>
<html lang="zh-TW" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="'食記：' + ${eatRepoDto.title} + ' 餐廳：' + ${eatRepoDto.restaurant.getName()} "></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
    <script>
    </script>
    <style>
        .notification {
        background-color: red; /* 綠色背景 */
        color: white; /* 白色文字 */
        text-align: center; /* 文字置中 */
        padding: 16px; /* 內邊距 */
        margin: 16px 0; /* 外邊距 */
        border-radius: 4px; /* 圓角 */
        }

    .notification.fade-in {
        animation: fadeIn 0.0s ease-in-out;
    }

    .notification.fade-out {
        animation: fadeOut 0.1s ease-in-out;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            visibility: hidden;
        }
        to {
            opacity: 1;
            visibility: visible;
        }
    }

    @keyframes fadeOut {
        from {
            opacity: 1;
            visibility: visible;
        }
        to {
            opacity: 0;
            visibility: hidden;
        }
    }

    </style>
</head>
<body>
<!-- Header區塊 -->
<header>
    <div th:insert="~{Fragment/Header :: header}"></div>
</header>

<!-- Main區塊 -->
<main>
    <div class="container-fluid d-flex flex-column"
         style="min-height: 100vh; background-color: rgb(240, 240, 240)">
        <div class="returnToResView">
            <input type="button"
                   th:value="'返回 ' + ${eatRepoDto.restaurant.getName()}"
                   th:onclick="|window.location.href='/ThinkEat/ViewEat/ResInfo/' + ${restaurantId} |">
        </div>
        <div class="repoTitleArea">
            <h3 th:text="${eatRepoDto.title}"></h3>
        </div>
        <section class="d-flex justify-content-center bg-light">
            <div th:each="imagePath : ${imagePaths}">
                <img th:src="${imagePath}" class="d-block w-50 h-50">
            </div>
            <!--圖片區
            <div id="carouselExampleControls" class="carousel slide"
                 data-bs-ride="carousel" data-bs-interval="false">
                <div class="carousel-inner" th:each="imagePath : ${imagePaths}">
                    <div class="carousel-item active">
                        <img th:src="${imagePath}" class="d-block w-50 h-50" alt="...">
                    </div>
                </div>
                    <button th:if="${#lists.size(imagePaths) > 1}" class="carousel-control-prev" type="button"
                            data-bs-target="#carouselExampleControls" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button th:if="${#lists.size(imagePaths) > 1}" class="carousel-control-next" type="button"
                            data-bs-target="#carouselExampleControls" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>

            </div>-->

            <!--文章區 -->
            <div class="eatInfoArea mx-2">
                <table>
                    <tr>
                        <td>文章Id：</td>
                        <td th:text="${eatRepoDto.id}"></td>
                    </tr>
                    <tr>
                        <td>餐廳名稱：</td>
                        <td th:text="${eatRepoDto.restaurant.getName()}"></td>
                    </tr>
                    <tr>
                        <td>地址：</td>
                        <td th:text="${eatRepoDto.restaurant.getAddress()}"></td>
                    </tr>
                    <tr>
                        <td>用餐日期：</td>
                        <td>
                            <span th:text="${#dates.format(eatRepoDto.date, 'yyyy-MM-dd E')}"></span>
                        </td>
                    </tr>
                    <tr>
                        <td>價位：</td>
                        <td th:text="${eatRepoDto.price.getName()}"></td>
                    </tr>
                    <tr>
                        <td>標籤：</td>
                        <td>
                            <span th:each="tag : ${eatRepoDto.eatRepo_TagList}"
                                  th:text="${tag.name}">、</span>
                        </td>
                    </tr>
                </table>
                <!-- 編輯文章和刪除文章的按鈕 -->
                <div class="d-flex">
                    <!-- 編輯文章 -->
                    <form method="get"
                          th:action="@{/ThinkEat/ShareEat/ShareEatRepo/Edit/{eatRepoId}(eatRepoId=${eatRepoDto.id})}">
                        <input type="submit" value="編輯文章">
                    </form>
                    <!-- 刪除文章 -->
                    <form method="post"
                          th:action="@{/ThinkEat/ShareEat/ShareEatRepo/Delete/{eatRepoId}(eatRepoId=${eatRepoDto.id})}">
                        <input type="submit" value="刪除文章">
                    </form>
                </div>

                <!--添加收藏-->
                <form method="post"
                      th:action="@{/ThinkEat/FavList/AddFavList/{eatRepoId}(eatRepoId=${eatRepoDto.id})}">
                    添加收藏：<select id="favListId" name="favListId">
                    <option th:each="favList : ${allFavList}"
                            th:value="${favList.id}"
                            th:text="${favList.favListName}">
                    </option>
                </select>

                    <input type="submit" value="添加收藏">
                </form>
                <!-- 在頁面中顯示通知 -->
                <div id="notification" th:if="${message}" class="notification fade-in">
                    <p th:text="${message}"></p>
                </div>
            </div>
        </section>
        </p>
        <!--  食記區  -->
        <section class="eatRepoArea">
            <div>
                <table>
                    <tr>
                        <td>使用者ID：</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>使用者名稱：</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>食記:</td>
                        <td th:text="${eatRepoDto.article}"></td>
                    </tr>
                </table>
            </div>
        </section>
        </p>
        <!-- 留言區 -->
        <section class="cmtArea ">
            <!-- 所有留言一覽區 -->
            <div class="row">
                <table>
                    <thead>
                    <tr>
                        <td>留言人</td>
                        <td>留言內容</td>
                        <td>
                            其他功能
                        </td>
                    </tr>
                    </thead>
                    <tbody th:each="commentDto : ${commentDtoList}">
                    <tr>
                        <td>placeholder</td>
                        <td th:text="${commentDto.commentContext}"></td>
                        <td>
                            <input type="button" method="post" th:value="'修改'">
                            <input type="button" method="post" th:value="'刪除'">
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            </p>
            <!-- 發表留言 -->
            <div class="row">
                <form th:action="@{/ThinkEat/ViewEat/EatRepo/PostComment}"
                      th:object="${commentDto}"
                      method="post">
                    <fieldset>
                        <legend>發表留言</legend>
                        <!-- 食記ID -->
                        <input id="eatRepoId" name="eatRepoId"
                               th:value="${eatRepoDto.id}"
                               type="hidden"/>
                        <textarea id="commentContext" name="commentContext"
                                  th:field="*{commentContext}"
                                  rows="5" cols="80"></textarea>
                        <P />
                        <input type="submit" value="發表留言">
                        <button type="reset">清空</button>
                    </fieldset>
                </form>

            </div>
        </section>

    </div>
</main>

<!-- 在頁面底部添加以下 JavaScript 代碼 -->
<script>
    // 監聽頁面載入事件
    document.addEventListener('DOMContentLoaded', function () {
        // 在通知顯示後，設置一定時間後自動隱藏
        var notification = document.getElementById('notification');
        if (notification) {
            setTimeout(function () {
                // 添加 'fade-out' 類別，觸發淡出效果
                notification.classList.add('fade-out');
                notification.addEventListener('animationend', function () {
                    // 動畫結束後將通知隱藏
                    notification.style.display = 'none';
                });
            }, 800); // 設定自動隱藏的時間，這裡設定為3秒（3000毫秒）
        }
    });
</script>

</body>
</html>




